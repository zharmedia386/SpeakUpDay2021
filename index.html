<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Form Speak Up Day 2021</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="template/vendors/feather/feather.css" />
    <!-- <link rel="stylesheet" href="template/vendors/mdi/css/materialdesignicons.min.css" /> -->
    <link rel="stylesheet" href="template/vendors/ti-icons/css/themify-icons.css" />
    <link rel="stylesheet" href="template/vendors/typicons/typicons.css" />
    <link rel="stylesheet" href="template/vendors/simple-line-icons/css/simple-line-icons.css" />
    <link rel="stylesheet" href="template/vendors/css/vendor.bundle.base.css" />
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <link rel="stylesheet" href="template/vendors/select2/select2.min.css" />
    <link rel="stylesheet" href="template/vendors/select2-bootstrap-theme/select2-bootstrap.min.css" />
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="template/css/vertical-layout-light/style.css" />
    <!-- CSS Tambahan -->
    <link rel="stylesheet" href="template/css/add.css" />
    <!-- endinject -->
    <link rel="shortcut icon" href="template\images\logo-himakom.png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  </head>

  <body>
    <div class="container-scroller">
      <!-- partial:../../partials/_navbar.html -->
        <!-- partial -->
        <div class="main-panel">
          <div class="content-wrapper d-flex justify-content-center">
            <div class="row">
              <div class="col-18 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <h4 class="card-title">Form Pemilihan Speaker Favorit</h4>
                    <form class="forms-sample" name="form-speakupday2021">
                      <div class="form-group">
                        <label for="exampleInputName1">Nama Lengkap <span style="color:red">*</span></label>
                        <input type="text" class="form-control" id="exampleInputName1" placeholder="Jawaban Anda..." name="nama-lengkap"/>
                      </div>
                      <div class="row">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label for="exampleInputName1">Pilihan Pemateri : <span style="color:red">*</span></label>
                            <div class="form-check">
                              <label class="form-check-label">
                                <input type="radio" class="form-check-input" name="pilihan-pemateri" id="optionsRadios1" value="Rachmat Purwa Saputra" checked>
                                Rachmat Purwa Saputra "Materi 1 : Kenalan dengan Bahasa Asing, Yuk"
                              </label>
                            </div>
                            <div class="form-check">
                              <label class="form-check-label">
                                <input type="radio" class="form-check-input" name="pilihan-pemateri" id="optionsRadios1" value="Syelvie Ira Ratna Mulia">
                                Syelvie Ira Ratna Mulia "Materi 2 : A little thing called passion"
                              </label>
                            </div>
                            <div class="form-check">
                              <label class="form-check-label">
                                <input type="radio" class="form-check-input" name="pilihan-pemateri" id="optionsRadios1" value="Adhitia Zain Nurrizki">
                                Adhitia Zain Nurrizki "Materi 3 : Kolaborasi Aksi"
                              </label>
                            </div>
                          </div>
                        </div>
                      </div>
                      <button type="submit" class="me-2 btn btn-primary btn-kirim" onclick="validateForm()">Kirim</button>
                      <button class="btn btn-light btnCancel" onclick="buttonCancel()">Cancel</button>
                      <button class="btn btn-dark btn-loading d-none" type="button" disabled>
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        Loading...
                      </button>
                    </form>
                    <br>
                       <div class="alert alert-success my-alert d-none" role="alert">
                          <strong>Terima kasih!</strong> Pesan anda sudah kami terima.
                       </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- content-wrapper ends -->
          <!-- partial:../../partials/_footer.html -->
          <footer class="footer">
            <div class="d-sm-flex justify-content-center justify-content-sm-between">
              <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">Speak Up Day 2021</span>
              <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center">Made with ❤️ using <a href="https://getbootstrap.com/" target="_blank">Bootstrap</a></span>
            </div>
          </footer>
          <!-- partial -->
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- Spreadsheet -->
    <script>
        function buttonCancel() {
            location.reload();
        }
        function validateForm() {
          const scriptURL = 'https://script.google.com/macros/s/AKfycbxhopVsiUSu9-PxyYeN86mLtlkZl83jv9KBwzXduXH6IcUKKRnnLNm8wPbwx4iyC6luVw/exec';
          const form = document.forms['form-speakupday2021'];
          const btnKirim = document.querySelector('.btn-kirim');
          const btnLoading = document.querySelector('.btn-loading');
          const myAlert = document.querySelector('.my-alert');
          const btnCancel = document.querySelector('.btnCancel');
          let x = document.forms['form-speakupday2021']['nama-lengkap'].value;
          if (x == '') {
            alert("Pastika semua data terisi!");
            return false;
          } else {
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                // ketika tombol submit diklik
                // tampilkan tombol loading, hilangkan tombol kirim
                btnLoading.classList.toggle('d-none');
                btnKirim.classList.toggle('d-none');
                btnCancel.classList.toggle('d-none');
                fetch(scriptURL, {
                        method: 'POST',
                        body: new FormData(form)
                    })
                    .then((response) => {
                        // tampilkan tombol kirim, hilangkan tombol loading
                        btnLoading.classList.toggle('d-none');
                        btnKirim.classList.toggle('d-none');
                        // tampilkan alert
                        myAlert.classList.toggle('d-none');
                        // reset formnya
                        form.reset();
                        console.log('Success!', response);
                    })
                    .catch((error) => console.error('Error!', error.message));
            });
            return true;
          }
        }
    </script>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="template/vendors/js/vendor.bundle.base.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <script src="template/vendors/typeahead.js/typeahead.bundle.min.js"></script>
    <script src="template/vendors/select2/select2.min.js"></script>
    <script src="template/vendors/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="template/js/off-canvas.js"></script>
    <script src="template/js/hoverable-collapse.js"></script>
    <script src="template/js/template.js"></script>
    <script src="template/js/settings.js"></script>
    <script src="template/js/todolist.js"></script>
    <!-- endinject -->
    <!-- Custom js for this page-->
    <script src="template/js/file-upload.js"></script>
    <script src="template/js/typeahead.js"></script>
    <script src="template/js/select2.js"></script>
    <!-- End custom js for this page-->
  </body>
</html>
